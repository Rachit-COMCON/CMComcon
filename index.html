<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calibration Report Generator</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="style.css">
</head>
<body class="bg-gray-100">

    <div class="app-container">
        <h1 class="text-2xl font-bold mb-4 text-center">Calibration Report Generator</h1>
        
        <form id="reportForm" class="space-y-4">
            <div class="grid grid-cols-1 md:grid-cols-2 gap-4">
                <div>
                    <label for="micName" class="block text-sm font-medium text-gray-700">Microphone Full Name</label>
                    <input type="text" id="micName" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" required>
                </div>
                <div>
                    <label for="serialNo" class="block text-sm font-medium text-gray-700">Serial Number</label>
                    <input type="text" id="serialNo" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" required>
                </div>
                <div>
                    <label for="operator" class="block text-sm font-medium text-gray-700">Operator Name</label>
                    <input type="text" id="operator" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" required>
                </div>
                <div>
                    <label for="calDate" class="block text-sm font-medium text-gray-700">Calibration Date</label>
                    <input type="date" id="calDate" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" required>
                </div>
            </div>

            <div class="border-t border-gray-200 pt-4">
                <h2 class="text-lg font-semibold mb-3">Reference Conditions</h2>
                <div class="grid grid-cols-3 gap-4">
                    <div>
                        <label for="temperature" class="block text-sm font-medium text-gray-700">Temperature (&deg;C)</label>
                        <input type="number" step="0.1" id="temperature" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" value="23.0">
                    </div>
                    <div>
                        <label for="humidity" class="block text-sm font-medium text-gray-700">Relative Humidity (%)</label>
                        <input type="number" step="0.1" id="humidity" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" value="50">
                    </div>
                    <div>
                        <label for="pressure" class="block text-sm font-medium text-gray-700">Barometric Pressure (hPa)</label>
                        <input type="number" step="0.1" id="pressure" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" value="1013.25">
                    </div>
                </div>
            </div>

            <div class="border-t border-gray-200 pt-4">
                <h2 class="text-lg font-semibold mb-3">Open Circuit Sensitivity</h2>
                <div class="grid grid-cols-2 gap-4">
                    <div>
                        <label for="ocSensitivity" class="block text-sm font-medium text-gray-700">Measured Level (mV/Pa)</label>
                        <input type="number" step="0.01" id="ocSensitivity" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" required value="0.39">
                    </div>
                    <div>
                        <label for="uncertainty" class="block text-sm font-medium text-gray-700">Uncertainty (dB)</label>
                        <input type="number" step="0.01" id="uncertainty" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" required value="0.09">
                    </div>
                </div>
            </div>

            <div class="border-t border-gray-200 pt-4">
                <h2 class="text-lg font-semibold mb-2">Frequency Response Data</h2>
                <p class="text-sm text-gray-500 mb-2">Enter your frequency response data as comma-separated pairs (e.g., 250,0.00, ...) or with each pair on a new line (e.g., 250&#9;0.00) with a tab character between them.</p>
                <textarea id="freqResponseData" rows="4" class="mt-1 block w-full px-3 py-2 border border-gray-300 rounded-md shadow-sm" placeholder="e.g., 250&#9;0.00&#10;500&#9;0.01&#10;1000&#9;0.00"></textarea>
            </div>
            
            <button type="submit" class="w-full bg-blue-600 hover:bg-blue-700 text-white font-bold py-2 px-4 rounded-md shadow-md transition-colors">
                Generate Report
            </button>
        </form>
    </div>

    <div id="reportContainer" class="report-container hidden">
        <div class="page-container flex flex-col justify-between">
            <div>
                <div class="flex items-center mb-6">
                    <div class="w-1.5 h-12 bg-blue-600 mr-4"></div>
                    <div>
                        <h1 class="text-xl font-bold">Calibration Chart</h1>
                        <p id="reportMicName1" class="text-lg font-medium">GRAS 40BH 1/4'' Ext. Polarized Pressure Microphone, High Pressure</p>
                    </div>
                </div>

                <div class="grid grid-cols-2 gap-x-8 gap-y-4 text-sm mb-4">
                    <div class="space-y-2">
                        <div class="flex justify-between">
                            <span class="font-semibold">Serial No:</span> <span id="reportSerialNo"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-semibold">Operator:</span> <span id="reportOperator"></span>
                        </div>
                        <div class="flex justify-between">
                            <span class="font-semibold">Calibration Date:</span> <span id="reportCalDate"></span>
                        </div>
                    </div>

                    <div>
                        <p class="font-semibold mb-2">Open Circuit Sensitivity</p>
                        <p class="text-xs leading-snug">The calibration is performed by comparison with a Reference Microphone Cartridge GRAS 40AG and is traceable to the Danish National Metrology Institute. DFM A/S. The stated sensitivity for the microphone cartridge is the open circuit sensitivity. When used with a typical preamplifier, like the GRAS 26AH, the sensitivity will be 0.2 dB lower.</p>
                        <table class="table-raw-data mt-4">
                            <thead>
                                <tr>
                                    <th>Test Freq. (Hz)</th>
                                    <th>Measured Level (mV/Pa)</th>
                                    <th>Measured Level (dB re 1 V/Pa)</th>
                                    <th>Uncertainty (dB)</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>250</td>
                                    <td id="reportOcSensitivity"></td>
                                    <td id="reportOcDb"></td>
                                    <td id="reportUncertainty"></td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                </div>
                
                <div class="grid grid-cols-2 gap-x-8 gap-y-4 text-sm mb-4">
                    <div class="space-y-2">
                        <h3 class="font-semibold">Reference conditions:</h3>
                        <div class="flex justify-between">
                            <p>Temperature:</p>
                            <span><span id="reportTemperature"></span>&nbsp;&deg;C</span>
                        </div>
                        <div class="flex justify-between">
                            <p>Relative humidity:</p>
                            <span><span id="reportHumidity"></span>&nbsp;%</span>
                        </div>
                        <div class="flex justify-between">
                            <p>Barometric pressure:</p>
                            <span><span id="reportPressure"></span>&nbsp;hPa</span>
                        </div>
                    </div>
                    
                    <div>
                        <h3 class="font-semibold">Frequency response</h3>
                        <p class="text-xs leading-snug">The table shows the frequency response for the microphone. The frequency response is recorded by electrostatic actuator and is measured relative to the response at 250 Hz.</p>
                    </div>
                </div>

                <div class="graph-wrapper">
                    <div class="graph-container">
                        <svg id="freqGraph" viewBox="0 0 1000 250" preserveAspectRatio="none">
                            <rect x="0" y="0" width="1000" height="250" fill="#f8f8f8"></rect>
                            
                            <text x="50" y="-10" font-size="20" font-weight="500" text-anchor="start">Frequency Response re. 250</text>
                            <text x="-40" y="125" font-size="15" text-anchor="middle" transform="rotate(-90 -40 125)">[dB]</text>
                            
                            <g id="yAxisGrid"></g>
                            <g id="xAxisGrid"></g>
                            <polyline id="graphLine" fill="none" stroke="blue" stroke-width="2"></polyline>
                        </svg>
                    </div>
                    <div class="text-sm text-center mt-4">Frequency (Hz)</div>
                </div>
            </div>
            
            <div class="footer-content">
                <div class="footer-left-section">
                    <div class="mic-details-footer">
                        <p class="font-medium text-black" id="footerMicName">GRAS 40BH 1/4" Ext. Polarized Pressure Microphone, High Pressure</p>
                        <p class="font-medium text-black">Serial No. <span id="footerSerialNo"></span></p>
                    </div>
                    <div class="gras-logo-wrapper">
                        <div class="gras-logo-bar"></div>
                        <img src="GRAS LOGO.png" alt="GRAS Sound & Vibration Logo">
                    </div>
                </div>
                
                <div class="footer-right-section">
                    <img src="intertek-certification-seeklogo.png" alt="Intertek Certification Logo" class="intertek-logo">
                    <p class="intertek-certification">Certificate number 48982</p>
                    <p class="footer-contact-info">GRAS Sound & Vibration A/S</p>
                    <p class="footer-contact-info">Skovlytoften 33, 2840 Holte, Denmark</p>
                    <p class="footer-contact-info">Email: <a href="mailto:support@gras.dk">support@gras.dk</a> - <a href="https://www.gras.dk">gras.dk</a></p>
                </div>
            </div>
        </div>

        <div class="page-container">
            <div class="flex items-center mb-6">
                <div class="w-1.5 h-12 bg-blue-600 mr-4"></div>
                <div>
                    <h1 class="text-xl font-bold">Calibration Chart</h1>
                    <p id="reportMicName2" class="text-lg font-medium">GRAS 40BH 1/4'' Ext. Polarized Pressure Microphone, High Pressure</p>
                </div>
            </div>

            <div class="flex text-sm mb-6">
                <div class="w-1/2 pr-8">
                    <p class="leading-snug">The GRAS 40BH Pressure Microphone complies with the requirements in IEC Standard 61094-4. The pressure microphone is designed to measure the sound pressure at the diaphragm. It has a flat pressure frequency</p>
                </div>
                <div class="w-1/2 pl-8">
                    <p class="leading-snug">in its entire frequency range. At higher frequencies the presence of the microphone itself in the sound field will change the sound pressure. In general the sound pressure around the microphone cartridge will increase due to reflections and diffraction. The pressure microphone is designed so that it measures the pressure on the diaphragm, including the influence of the microphone on the sound field.</p>
                </div>
            </div>

            <div class="w-full h-px bg-gray-300 my-6"></div>

            <div class="grid grid-cols-2 gap-x-8 gap-y-4 text-sm mb-6">
                <div class="space-y-2">
                    <div class="flex justify-between">
                        <span class="font-semibold">Nominal Sensitivity at 250 Hz:</span> <span>0.4 mV/Pa</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-semibold">Frequency Response &plusmn;2 dB:</span> <span>10 Hz - 20 kHz</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-semibold">Dynamic Range:</span> 
                        <span>from 54 dBA re. 20 &mu;Pa<br>to 193 dB re. 20 &mu;Pa</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-semibold">Polarization Voltage:</span> <span>200 V</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-semibold">Pistonphone Volume Correction:</span> <span>0.002 dB</span>
                    </div>
                    <div class="flex justify-between">
                        <span class="font-semibold">Typical gain with Preamplifier &frac14;" Preamplifier:</span> <span>Typ. -0.48 dB</span>
                    </div>
                </div>
                
                <div class="mb-6">
                    <h2 class="text-md font-semibold mb-2">Frequency Response Raw Data</h2>
                    <table class="table-raw-data-page2">
                        <thead>
                            <tr>
                                <th>Frequency (Hz)</th>
                                <th>Pressure (dB)</th>
                                <th>Frequency (Hz)</th>
                                <th>Pressure (dB)</th>
                            </tr>
                        </thead>
                        <tbody id="freqTableBody">
                            </tbody>
                    </table>
                </div>
            </div>

            <div>
                <h2 class="text-md font-semibold mb-2">Traceability Table</h2>
                <table class="table-traceability">
                    <thead>
                        <tr>
                            <th>Instrument</th>
                            <th>Model</th>
                            <th>Serial Number</th>
                            <th>Traceable To</th>
                            <th>Calibration Date</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr>
                            <td>NI data-acquisition signal analyzer</td>
                            <td>PCI-4461</td>
                            <td>33611572</td>
                            <td>NIST</td>
                            <td>29-05-2025</td>
                        </tr>
                        <tr>
                            <td>Pistonphone</td>
                            <td>42AP</td>
                            <td>433872</td>
                            <td>DFM</td>
                            <td>24-06-2025</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>